<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificando tu cuenta</title>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@15.0.0"></script>
    <style>
        body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #121212; color: #eee; margin: 0; padding: 20px; box-sizing: border-box; }
        #container { background-color: #1e1e1e; padding: 40px; border-radius: 12px; text-align: center; max-width: 400px; width: 100%; }
        h1 { font-size: 24px; margin-bottom: 20px; color: #ff4d00; }
        p { font-size: 16px; line-height: 1.6; }
        .success { color: #4CAF50; }
        .error { color: #F44336; }
    </style>
</head>
<body>
    <div id="container">
        <h1 id="status-title">Verificando tu cuenta...</h1>
        <p id="status-message">Por favor, esperá un momento.</p>
    </div>

    <script>
        // --- ¡CONFIGURÁ ESTO! ---
        const PROJECT_ID = '684a25050005e78945d0'; // Tu Project ID de Appwrite
        const ENDPOINT = 'https://fra.cloud.appwrite.io/v1'; // Tu Endpoint de la Nube
        // --------------------------

        const statusTitle = document.getElementById('status-title');
        const statusMessage = document.getElementById('status-message');
        const { Client, Account } = Appwrite;
        const client = new Client().setEndpoint(ENDPOINT).setProject(PROJECT_ID);
        const account = new Account(client);

        // 1. Leemos los parámetros 'userId' y 'secret' de la URL
        const urlParams = new URLSearchParams(window.location.search);
        const secret = urlParams.get('secret');
        const userId = urlParams.get('userId');

        // 2. Llamamos a updateVerification (como dice la documentación)
        if (secret && userId) {
            account.updateVerification(userId, secret)
                .then(response => {
                    statusTitle.textContent = '¡Cuenta Verificada!';
                    statusTitle.className = 'success';
                    statusMessage.textContent = 'Tu email ha sido verificado. Ya podés cerrar esta pestaña y volver a la app para iniciar sesión.';
                })
                .catch(error => {
                    statusTitle.textContent = 'Error en la Verificación';
                    statusTitle.className = 'error';
                    statusMessage.textContent = 'El enlace es inválido o ha expirado. Por favor, intentá reenviar el correo desde la app.';
                });
        } else {
            statusTitle.textContent = 'Enlace Inválido';
            statusTitle.className = 'error';
            statusMessage.textContent = 'Faltan los parámetros de verificación.';
        }
    </script>
</body>
</html>
